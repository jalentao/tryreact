<!DOCTYPE HTML>
<html lang="zh-Hans-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no,email=no" />
    <!--#include virtual="/sinclude/common/weixin/weixin_dns_prefetch.shtml" -->

    <title>麦大大管家</title>

    <!--#include virtual="/sinclude/common/weixin/weixin_oneapm_js.shtml" -->
    <!--#include virtual="/sinclude/common/weixin/weixin_common_css.shtml" -->
    <link href="http://www.maidada.cn/static/weixin/css/weixin_zl.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        body {
            width: 100%;
            height: 100%;
            background: #242529 no-repeat;
            background-size: cover;
        }
    </style>
</head>

<body>
    <div class="top">请选择您需要的服务</div>

    <ul class="ul_list" id="ul_service_list">
    </ul>
    <script id="template_service_list" type="x-tmpl-mustache">
        {{#services}}
        <li data-service_type="{{type}}"><a href="javascript:void(0)">{{name}}</a></li>
        {{/services}}
    </script>

    <!--#include virtual="/sinclude/common/weixin/weixin_common_js.shtml" -->
    <script type="text/javascript">
        $(function() {

            LogCol && window.LogCol.upLog();

            // MaiDaDa.listOurServices 的回调方法
            var list_our_services_callback = function(service_list, status) {
                if (status === true) {
                    if (service_list.length <= 0) {
                        MaiDaDa.clearAllItems();
                        layer.open({
                            content: '浏览器错误，请刷新重试(48)',
                            btn: ['OK']
                        });
                        window.location.reload();
                        return false;
                    }
                    var template = $('#template_service_list').html();
                    var rendered = Mustache.render(template, {
                        services: service_list
                    });
                    $('#ul_service_list').html(rendered);
                } else {
                    layer.open({
                        content: MaiDaDa.getErrorMessage(),
                        btn: ['OK']
                    });
                    return false;
                }
            };

            // 列出所有的服务
            MaiDaDa.listOurServices(list_our_services_callback);

            // 点击对应的服务后跳转
            $("#ul_service_list").on("tap", "li", function() {
                var type = parseInt($(this).attr("data-service_type"), 10);
                switch (type) {
                    case 4: // 4: 处理违章
                        LogCol && window.LogCol.event({
                            "event": "点击『违章』",
                        });
                        window.location.assign("http://www.maidada.cn/app/download.shtml?ttag=wx_servicess&remind=weixin_not_support_service&service=4");
                        break;
                    case 5: // 5: 进京证
                        LogCol && window.LogCol.event({
                            "event": "点击『进京证』",
                        });
                        window.location.assign("http://www.maidada.cn/app/download.shtml?ttag=wx_servicess&remind=weixin_not_support_service&service=5");
                        break;
                    case 20: // 20: 是熟悉管家的需求
                        window.location.assign("make.shtml?ttag=wx_services&type=" + type);
                        break;
                    case 8: // 8: 年检
                        window.location.assign("pre-8.shtml?ttag=wx_services&type=" + type);
                        break;
                    case 3: // 3: 保养
                        window.location.assign("pre-3.shtml?ttag=wx_services&type=" + type);
                        break;
                    case 6: // 6: 板喷
                        window.location.assign("pre-6.shtml?ttag=wx_services&type=" + type);
                        break;
                    case 7: // 7: 内饰清洁
                        window.location.assign("pre-7.shtml?ttag=wx_services&type=" + type);
                        break;
                    case 10: // 10: 漆面护理
                        window.location.assign("pre-10.shtml?ttag=wx_services&type=" + type);
                        break;
                    case 12: // 12: 贴膜
                        window.location.assign("pre-12.shtml?ttag=wx_services&type=" + type);
                        break;
                    default:
                        break;
                }
            });
        });
    </script>
</body>

</html>
